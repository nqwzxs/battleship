(()=>{"use strict";var e={150:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(81),a=n.n(r),s=n(645),o=n.n(s)()(a());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap);"]),o.push([e.id,":root {\n  font-size: 16px;\n  font-family: 'JetBrains Mono', monospace;\n\n  --background-color: #f5f5f4;\n  --border-color: #57534e;\n  --ship-color: #a8a29e;\n  --ship-shot-color: #ea580c;\n  --ship-sunk-color: #991b1b;\n  --shot-color: #0284c7;\n  --valid-place-color: #4ade80;\n  --invalid-place-color: #f87171;\n  --hover-color: rgba(168, 162, 158, 0.25);\n}\n\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  background: var(--background-color);\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.wrapper {\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n  align-items: center;\n}\n\nheader {\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  font-size: 2rem;\n}\n\nbutton {\n  font-size: 1rem;\n  font-family: 'JetBrains Mono', monospace;;\n  padding: 1rem 2rem;\n  cursor: pointer;\n  border: 1px solid var(--border-color);\n}\n\nbutton:hover {\n  background: var(--hover-color);\n}\n\nmain {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 2.7rem\n}\n\n.gameboard-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  position: relative;\n}\n\n.gameboard {\n  width: 24rem;\n  height: 24rem;\n  display: grid;\n  grid-template: repeat(10, 1fr) / repeat(10, 1fr);\n  gap: 0.15rem;\n}\n\n.gameboard .square {\n  background: white;\n  border: var(--border-color) 1px solid;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.computer-gameboard-container .gameboard.active\n.square:not(.has-ship-shot):not(.has-ship-sunk).square:not(.has-missed-shot):hover {\n  background: var(--hover-color);\n  transition: .1s;\n  cursor: crosshair;\n}\n\n.gameboard .invalid-place {\n  background: var(--invalid-place-color);\n  cursor: pointer;\n  transition: .1s;\n}\n\n.gameboard .valid-place {\n  background: var(--valid-place-color);\n  cursor: pointer;\n  transition: .1s;\n}\n\n.gameboard .has-ship {\n  background: var(--ship-color);\n}\n\n.gameboard .has-missed-shot {\n  background: var(--shot-color);\n}\n\n.gameboard .has-missed-shot::after {\n  content: '●';\n  padding-bottom: 4px;\n}\n\n.gameboard .has-ship-shot {\n  background: var(--ship-shot-color)\n}\n\n.gameboard .has-ship-shot::after,\n.gameboard .has-ship-sunk::after {\n  content: '✖';\n  font-size: 1.6rem;\n}\n\n.gameboard .has-ship-sunk {\n  background: var(--ship-sunk-color)\n}\n\n.gameboard:not(.active) {\n  opacity: 50%;\n}\n\n.modal {\n  background: var(--background-color);\n  width: 100%;\n  position: absolute;\n  padding: 2rem;\n  text-align: center;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1;\n  visibility: hidden;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}",""]);const i=o},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,a,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(o[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);r&&o[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},o=[],i=0;i<e.length;i++){var c=e[i],l=r.base?c[0]+r.base:c[0],d=s[l]||0,u="".concat(l," ").concat(d);s[l]=d+1;var h=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var m=a(p,r);r.byIndex=i,t.splice(i,0,{identifier:u,updater:m,references:1})}o.push(u)}return o}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var s=r(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var i=n(s[o]);t[i].references--}for(var c=r(e,a),l=0;l<s.length;l++){var d=n(s[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{var e=n(379),t=n.n(e),r=n(795),a=n.n(r),s=n(569),o=n.n(s),i=n(565),c=n.n(i),l=n(216),d=n.n(l),u=n(589),h=n.n(u),p=n(150),m={};m.styleTagTransform=h(),m.setAttributes=c(),m.insert=o().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=d(),t()(p.Z,m),p.Z&&p.Z.locals&&p.Z.locals;class f{constructor(){this.attackingShip=!1,this.directions={}}attack(e){this.attackingShip?this.attackDirection(e):this.attackRandom(e)}attackDirection(e){const t=Math.floor(Math.random()*Object.keys(this.directions).length),n=Object.values(this.directions)[t][0];n&&!n.shot?(e.receiveAttack(n),n.ship&&n.ship.sunken?(this.attackingShip=!1,this.directions=[]):n.ship&&(Object.values(this.directions)[t].shift(),"left"===Object.keys(this.directions)[t]||"right"===Object.keys(this.directions)[t]?(this.directions.down=[],this.directions.up=[]):(this.directions.left=[],this.directions.right=[]))):this.attackDirection(e)}attackRandom(e){const t=e.getRandomSquare();t.shot?this.attackRandom(e):(e.receiveAttack(t),t.ship&&(this.attackingShip=!0,this.directions=e.createDirections(t)))}}class v{constructor(e){this.length=e,this.hits=0,this.sunken=!1}hit(){this.hits+=1,this.sunken=this.isSunk()}isSunk(){return this.hits===this.length}}class g{constructor(){this.squares=g.#e(),this.ships=g.#t()}static#e(){const e=[];for(let t=0;t<10;t++)for(let n=0;n<10;n++){const r={coordinates:{row:t,col:n},ship:null,shot:!1,busy:!1};e.push(r)}return e}static#t(){return{Carrier:new v(5),Battleship:new v(4),Cruiser:new v(3),Submarine:new v(3),Destroyer:new v(2)}}static#n(e,t,n,r){return r?t+e>10:n+e>10}static#r(e){return e.some((e=>e.busy))}removeShips(){this.squares.forEach((e=>{e.ship=null}))}selectSquare(e,t){return this.squares.find((n=>n.coordinates.row===e&&n.coordinates.col===t))}selectSquares(e,t,n,r){if(g.#n(e,t,n,r))return null;const a=[];for(let s=0;s<e;s++){const e=r?this.selectSquare(t+s,n):this.selectSquare(t,n+s);a.push(e)}return g.#r(a)?null:a}#a(e){const t=[];return this.squares.forEach((n=>{n.ship===e&&t.push(n)})),t}placeShip(e,t){t.forEach((t=>{t.ship=e,t.busy=!0,this.#s(t).forEach((e=>{e.busy=!0}))}))}#s(e){const t=[];return[[0,1],[0,-1],[1,0],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]].forEach((n=>{const[r,a]=n,s=this.selectSquare(e.coordinates.row+r,e.coordinates.col+a);s&&t.push(s)})),t}receiveAttack(e){e.shot||(e.ship&&(e.ship.hit(),e.ship.sunken)&&this.#a(e.ship).forEach((e=>{this.#s(e).forEach((e=>{e.shot=!0}))})),e.shot=!0)}allSunk(){return Object.values(this.ships).every((e=>e.sunken))}static#o(){return Math.floor(10*Math.random())}getRandomSquare(){const e=g.#o(),t=g.#o();return this.selectSquare(e,t)}#i(e){const t=g.#o(),n=g.#o(),r=Math.random()<.5;return this.selectSquares(e.length,t,n,r)||this.#i(e)}placeShipsRandomly(){Object.values(this.ships).forEach((e=>{const t=this.#i(e);this.placeShip(e,t)}))}createDirections(e){const t={right:[],left:[],down:[],up:[]},n=[[0,1],[0,-1],[1,0],[-1,0]];for(let r=0;r<Object.keys(t).length;r++){let{row:a,col:s}=e.coordinates,o=null;do{a+=n[r][0],s+=n[r][1],o=this.selectSquare(a,s),o&&Object.values(t)[r].push(o)}while(o)}return t}}class b{constructor(){this.gameboard=new g}}class y{constructor(){this.players={human:new b,computer:new b}}}let k,S,w;const q=document.querySelector(".modal");function L(e,t){const n=t?S:w;n.innerHTML="",e.gameboard.squares.forEach((e=>{const r=document.createElement("div");r.dataset.row=e.coordinates.row,r.dataset.col=e.coordinates.col,r.classList.add("square"),e.ship&&t&&r.classList.add("has-ship"),e.ship&&e.ship.sunken?r.classList.add("has-ship-sunk"):e.shot&&e.ship?r.classList.add("has-ship-shot"):e.shot&&r.classList.add("has-missed-shot"),n.appendChild(r)}))}function x(){L(k.players.human,!0),L(k.players.computer,!1)}function E(){S.classList.add("active");const e=q.querySelector("button");let t=null,n=!1,r=0,a=Object.values(k.players.human.gameboard.ships)[r];function s(){const e=S.childNodes,r=k.players.human.gameboard.selectSquares(a.length,+t.dataset.row,+t.dataset.col,n);r?r.forEach((t=>{const{row:n,col:r}=t.coordinates;e.forEach((e=>{e.dataset.row===n.toString()&&e.dataset.col===r.toString()&&e.classList.add("valid-place")}))})):t.classList.add("invalid-place")}function o(){S.childNodes.forEach((e=>{e.classList.remove("valid-place"),e.classList.remove("invalid-place")}))}function i(e){"r"===e.key&&(n=!0!==n,o(),s())}function c(e){e.target.classList.contains("square")&&(t=e.target,o(),s())}function l(e){if(!e.target.classList.contains("square"))return;const o=k.players.human.gameboard.selectSquares(a.length,+t.dataset.row,+t.dataset.col,n);o&&(k.players.human.gameboard.placeShip(a,o),r+=1,a=Object.values(k.players.human.gameboard.ships)[r],r>4?u():(s(),x()))}function d(){k.players.human.gameboard.removeShips(),k.players.human.gameboard.placeShipsRandomly(),u()}function u(){window.removeEventListener("keyup",i),S.removeEventListener("mouseover",c),S.removeEventListener("mouseleave",o),S.removeEventListener("click",l),e.removeEventListener("click",d),q.innerHTML="",q.style.visibility="hidden",k.players.computer.gameboard.placeShipsRandomly(),x(),function(){let e;w.classList.add("active");const t=new f;w.addEventListener("click",(function n(r){if(!r.target.classList.contains("square"))return;const{row:a,col:s}=r.target.dataset;if(e=k.players.computer.gameboard.selectSquare(+a,+s),!e.shot){if(k.players.computer.gameboard.receiveAttack(e),x(),k.players.computer.gameboard.allSunk())return w.removeEventListener("click",n),w.classList.remove("active"),S.classList.remove("active"),q.textContent="Congratulations! You won!",void(q.style.visibility="visible");t.attack(k.players.human.gameboard),x(),k.players.human.gameboard.allSunk()&&(w.removeEventListener("click",n),w.classList.remove("active"),S.classList.remove("active"),q.textContent="You lost!",q.style.visibility="visible")}}))}()}window.addEventListener("keyup",i),S.addEventListener("mouseover",c),S.addEventListener("mouseleave",o),S.addEventListener("click",l),e.addEventListener("click",d)}function C(){k=new y,document.querySelectorAll(".gameboard-container").forEach((e=>{const t=e.querySelector(".gameboard");null!==t&&e.removeChild(t);const n=document.createElement("div");n.classList.add("gameboard"),e.appendChild(n)})),S=document.querySelector(".human-gameboard-container .gameboard"),w=document.querySelector(".computer-gameboard-container .gameboard"),x(),function(){q.textContent="Place your ships (press R to rotate)",q.style.visibility="visible";const e=document.createElement("button");e.textContent="Randomize",q.appendChild(e)}(),E()}document.querySelector(".new-game-button").addEventListener("click",C),C()})()})();